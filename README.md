# AIChallenge

AIChallenge ‚Äî Android‚Äë–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Jetpack Compose, –∫–æ—Ç–æ—Ä–æ–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–µ HTTP/WS‚Äë—Å–µ—Ä–≤–µ—Ä—ã –∏ —Å–≤—è–∑—ã–≤–∞–µ—Ç –∏—Ö —Å LLM (Yandex GPT 5.1 –∏ Hugging Face) –∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏ MCP‚Äë–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ñ–ª–∞–π–Ω‚Äë—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π UI, —É–º–µ–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏—Å—Ç–æ—Ä–∏—é –¥–∏–∞–ª–æ–≥–∞, –≤—ã–∑—ã–≤–∞—Ç—å MCP‚Äëtools –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –∏—Ö —Å–ø–∏—Å–æ–∫ –ø—Ä—è–º–æ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –î–≤–∞ —Ä–µ–∂–∏–º–∞ —á–∞—Ç–∞: `LocalAiServer` (Yandex Cloud) –∏ `HuggingFaceLocal` (Router API) –ø–æ–¥ —Ç–µ–º –∂–µ REST‚Äë–∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–º (`/chat`, `/history`, `/clear`).
- –õ–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä —É–º–µ–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –≤ —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö MCP‚Äë–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å –º–æ–¥–µ–ª—å, –ø–æ–∫–∞ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –Ω–µ –∑–∞–≤–µ—Ä—à–∏—Ç —Ü–µ–ø–æ—á–∫—É MCP_TOOL.
- –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `filesDir/local_ai_history.json`, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∂–∏–º–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ 10 —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—á–∏—â–µ–Ω–∞ –∏–∑ UI.
- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ MCP‚Äë—Å–µ—Ä–≤–µ—Ä—ã (–Ω–∞ Ktor SSE) –ø—É–±–ª–∏–∫—É—é—Ç –¥–∞–Ω–Ω—ã–µ –∫–∞–º–ø–∞–Ω–∏–π DnD –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª —á–µ—Ä–µ–∑ —ç–∫—Ä–∞–Ω Tools.
- –•—É–∫–∏ –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π issue summary —á–µ—Ä–µ–∑ WebSocket –∏ GitHub MCP‚Äëtool (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ—Ç–∫–ª—é—á–µ–Ω—ã, —Å–º. –Ω–∏–∂–µ).

## –°–µ–∫—Ä–µ—Ç—ã –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–í—Å–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –∫–ª—é—á–∏ —á–∏—Ç–∞—é—Ç—Å—è –∏–∑ `local.properties` (—Å–º. `app/build.gradle.kts`):

```
YANDEX_API_KEY=<—Å–µ—Ä–≤–µ—Ä–Ω—ã–π API-–∫–ª—é—á YandexGPT>
YC_FOLDER_ID=<ID –∫–∞—Ç–∞–ª–æ–≥–∞ –≤ Yandex Cloud>
HF_TOKEN=<Personal Access Token Hugging Face>
GITHUB_TOKEN=<–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω—É–∂–µ–Ω –¥–ª—è github_issue_comments –∏ github_repos>
```

- –ë–µ–∑ `YANDEX_API_KEY`/`YC_FOLDER_ID` `LocalAiServer` –≤–µ—Ä–Ω—ë—Ç 400.
- –ë–µ–∑ `HF_TOKEN` `HuggingFaceLocal` –Ω–µ —Å–º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å Router API.
- `GITHUB_TOKEN` —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è –≤–∫–ª—é—á–∏—Ç—å GitHub‚Äë–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –≤ `McpServerManager` –∏/–∏–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ issue summary.

## –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å
1. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –∏ —Å–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (`./gradlew installDebug` –ª–∏–±–æ Run –≤ Android Studio).
2. –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø–æ—è–≤–∏—Ç—Å—è `StartScreen` (`MainActivity`): –æ—Ç—Å—é–¥–∞ –º–æ–∂–Ω–æ
   - –∑–∞–ø—É—Å—Ç–∏—Ç—å —á–∞—Ç —Å Yandex (`Yandex Chat (LocalAiServer)`), 
   - –∑–∞–ø—É—Å—Ç–∏—Ç—å —á–∞—Ç —Å HuggingFace (`Hugging Chat`),
   - –æ—Ç–∫—Ä—ã—Ç—å —Å–ø–∏—Å–æ–∫ MCP‚Äë–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (`MCP Tools`),
   - —Å—Ç–∞—Ä—Ç–æ–≤–∞—Ç—å/–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–±–∞ MCP‚Äë—Å–µ—Ä–≤–µ—Ä–∞ –æ–¥–Ω–æ–π –∫–Ω–æ–ø–∫–æ–π.
3. –ö–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞ —á–∞—Ç–∞ —Å—Ç–∞—Ä—Ç—É–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π NanoHTTPD‚Äë—Å–µ—Ä–≤–µ—Ä –Ω–∞ `127.0.0.1:8080` –∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç UI –Ω–∞ Compose‚Äë—á–∞—Ç.
4. –î–ª—è Hugging Face –º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –º–æ–¥–µ–ª—å —á–µ—Ä–µ–∑ –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ (`Model` enum). –ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞ –æ–±—â–∞—è, –ø–æ—ç—Ç–æ–º—É –ø–æ—Å–ª–µ —Å–º–µ–Ω—ã —Å–µ—Ä–≤–µ—Ä–∞ –µ—ë –ª—É—á—à–µ –æ—á–∏—Å—Ç–∏—Ç—å.

## UI –∏ –∫–ª–∏–µ–Ω—Ç—Å–∫–∞—è —á–∞—Å—Ç—å
- `StartScreen` (–≤ `MainActivity.kt`) –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ MCP‚Äë—Å–µ—Ä–≤–µ—Ä–æ–≤ –∏ –∏—Ö endpoint‚Äë—ã, –∞ —Ç–∞–∫–∂–µ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ life‚Äëcycle –ª–æ–∫–∞–ª—å–Ω—ã—Ö HTTP‚Äë—Å–µ—Ä–≤–µ—Ä–æ–≤.
- `ChatScreen` (`chat/ChatScreen.kt`) ‚Äî UI –¥–ª—è –ª—é–±–æ–≥–æ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞: –∞–≤—Ç–æ—Å–∫—Ä–æ–ª–ª, –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ —Ç–∞–ø—É, –æ—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏, –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –æ—Ç–ø—Ä–∞–≤–∫–∏.
- `HuggingChatScreen` –¥–æ–±–∞–≤–ª—è–µ—Ç –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ Hugging Face, –Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ—Ç –∂–µ `ChatViewModel`.
- `ChatViewModel` (`chat/ChatViewModel.kt`) —Ä–∞–±–æ—Ç–∞–µ—Ç —Å `LocalApi` (Retrofit, `api/LocalApi.kt`) –∏:
  - –ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é —á–µ—Ä–µ–∑ `GET /history`,
  - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è `POST /chat`,
  - –æ—á–∏—â–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é `POST /clear`,
  - —É–º–µ–µ—Ç –¥–µ—Ä–∂–∞—Ç—å WebSocket `ws://127.0.0.1:8080/issueSummary`, –Ω–æ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ `ISSUE_SUMMARY_WS_ENABLED` —Å–µ–π—á–∞—Å `false`.
- `ApiModule` —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç –±–∞–∑–æ–≤—ã–π URL `http://127.0.0.1:8080/`, –ø–æ—ç—Ç–æ–º—É –ª—é–±–æ–π —Å–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω —Å–æ–±–ª—é–¥–∞—Ç—å –∫–æ–Ω—Ç—Ä–∞–∫—Ç `/chat`/`/history`/`/clear`.

### –ò—Å—Ç–æ—Ä–∏—è –∏ issue summary
- `LocalAiServer` —Ö—Ä–∞–Ω–∏—Ç ¬´–ø–µ—Ä–º–∞–Ω–µ–Ω—Ç–Ω—É—é¬ª –∏—Å—Ç–æ—Ä–∏—é (–¥–ª—è –º–æ–¥–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –ø–æ–º–Ω–∏—Ç—å –≤—Å—ë) –∏ —á–∏—Å—Ç—É—é –∏—Å—Ç–æ—Ä–∏—é, –∏—Å–ø–æ–ª—å–∑—É—è —Ñ–∞–π–ª `local_ai_history.json`.
- –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Ä–µ–ø–ª–∏–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ª–∏–º–∏—Ç `MAX_HISTORY_MESSAGES` (10), –∏ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å –∫ LLM –¥–ª—è —Å–∂–∞—Ç–∏—è –∏—Å—Ç–æ—Ä–∏–∏ (—Å–º. `requestHistoryCompression`).
- WebSocket `/issueSummary` –∏ —Ñ–æ–Ω–æ–≤—ã–π job –≤–∫–ª—é—á–∞—é—Ç—Å—è —Ñ–ª–∞–≥–æ–º `ISSUE_SUMMARY_FEATURE_ENABLED`. –ß—Ç–æ–±—ã –ø–æ—Ç–æ–∫ –∑–∞—Ä–∞–±–æ—Ç–∞–ª, –Ω—É–∂–Ω–æ:
  1. –≤–∫–ª—é—á–∏—Ç—å —Ñ–ª–∞–≥–∏ –≤ `LocalAiServer` –∏ `ChatViewModel`,
  2. —É–∫–∞–∑–∞—Ç—å `GITHUB_TOKEN`,
  3. –∑–∞–ø—É—Å—Ç–∏—Ç—å MCP‚Äë—Å–µ—Ä–≤–µ—Ä —Å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º `github_issue_comments`.

## –õ–æ–∫–∞–ª—å–Ω—ã–µ LLM‚Äë—Å–µ—Ä–≤–µ—Ä—ã

### LocalAiServer (Yandex GPT 5.1)
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ `server/LocalAiServer.kt` –∏ –Ω–∞—Å–ª–µ–¥—É–µ—Ç `NanoWSD`, –ø–æ—ç—Ç–æ–º—É –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç REST –∏ WebSocket:

- **REST API:** `POST /chat`, `GET /history`, `POST /clear`. –í –æ—Ç–≤–µ—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —Å—á—ë—Ç—á–∏–∫–∏ —Ç–æ–∫–µ–Ω–æ–≤ –∏ `request_time_ms`.
- **–°–±–æ—Ä –ø—Ä–æ–º–ø—Ç–∞:** —Å–∏—Å—Ç–µ–º–∞ (`Role.DEFAULT`), –æ–ø–∏—Å–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (`buildToolSummary()` –≤—ã–∑—ã–≤–∞–µ—Ç `McpClient.fetchAllTools()`), —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –∏ –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- **–í—ã–∑–æ–≤ MCP tools:** —Å–µ—Ä–≤–µ—Ä –∏—â–µ—Ç –º–∞—Ä–∫–µ—Ä `MCP_TOOL:` –≤ –æ—Ç–≤–µ—Ç–µ LLM. –ï—Å–ª–∏ –æ–Ω –µ—Å—Ç—å, JSON –ø–∞—Ä—Å–∏—Ç—Å—è –≤ (`server`, `name`, `parameters`), –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `McpClient.callTool`, –∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –º–æ–¥–µ–ª–∏ –≤ –≤–∏–¥–µ –Ω–æ–≤–æ–π user‚Äë—Ä–µ–ø–ª–∏–∫–∏. –¶–∏–∫–ª –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è, –ø–æ–∫–∞ –º–æ–¥–µ–ª—å –Ω–µ –ø–µ—Ä–µ—Å—Ç–∞–Ω–µ—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã.
- **–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å:** –∏—Å—Ç–æ—Ä–∏—è –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è –≤ `permanentHistory` –∏ –Ω–∞ –¥–∏—Å–∫. –§–æ–Ω–æ–≤–∞—è –∫–æ–º–ø—Ä–µ—Å—Å–∏—è –¥–µ—Ä–∂–∏—Ç—Å—è –≤ `CoroutineScope` —Å `SupervisorJob`.
- **Issue summary:** –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ `ISSUE_SUMMARY_FEATURE_ENABLED` –∫–∞–∂–¥—ã–µ `ISSUE_SUMMARY_REFRESH_MS` –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥ –ø–æ–¥—Ç—è–≥–∏–≤–∞—é—Ç—Å—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —á–µ—Ä–µ–∑ MCP‚Äëtool `github_issue_comments`, summary –≥–µ–Ω–µ—Ä–∏—Ç—Å—è –º–æ–¥–µ–ª—å—é –∏ —Ä–∞—Å—Å—ã–ª–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ WebSocket (–ø–ª—é—Å heartbeat –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥).

### HuggingFaceLocal
(`server/HuggingFaceLocal.kt`)
- –†–∞–±–æ—Ç–∞–µ—Ç —Å Router API (`https://router.huggingface.co/v1/chat/completions`) –∏ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–µ –∂–µ –∑–∞–ø—Ä–æ—Å—ã `/chat`.
- –°–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π –∑–∞–¥–∞—ë—Ç—Å—è enum `Model` (`server/Model.kt`). –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –º–æ–¥–µ–ª—å —Å `isPermanentHistoryNeeded = true` –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ¬´–ø–µ—Ä–º–∞–Ω–µ–Ω—Ç–Ω–æ–π¬ª –∏—Å—Ç–æ—Ä–∏–∏.
- –í –æ—Ç–≤–µ—Ç —Ç–∞–∫–∂–µ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —Å—á—ë—Ç—á–∏–∫–∏ —Ç–æ–∫–µ–Ω–æ–≤ Hugging Face.
- –°–µ—Ä–≤–µ—Ä —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –≤ `HuggingServerRegistry`, —á—Ç–æ–±—ã UI –º–æ–≥ –º–µ–Ω—è—Ç—å –º–æ–¥–µ–ª—å –Ω–∞ –ª–µ—Ç—É.

## MCP‚Äë—Å–ª–æ–π

### McpServers –∏ ToolsScreen
- `McpServers` (`mcp/McpServers.kt`) –æ–ø–∏—Å—ã–≤–∞–µ—Ç –≤—Å–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ MCP‚Äë—Å–µ—Ä–≤–µ—Ä—ã: `core` –∏ `knowledge`. –ö–∞–∂–¥—ã–π –∑–Ω–∞–µ—Ç, –∫–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –∏ –∫–∞–∫–æ–π endpoint (`http://127.0.0.1:11020/mcp` –∏ `http://127.0.0.1:11030/mcp`).
- `McpServers.startAll()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Å –≥–ª–∞–≤–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞. `McpClient` –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –∑–∞–ø—Ä–æ—Å–æ–º —É–±–µ–∂–¥–∞–µ—Ç—Å—è, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω.
- `ToolsScreen` + `ToolsViewModel` (`mcp/ToolsScreen.kt`, `mcp/ToolsViewModel.kt`) –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ –∏ –∏—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—è `McpClient.fetchAllTools()`.

### McpServerManager (core)
- –†–µ–∞–ª–∏–∑—É–µ—Ç SSE‚Äë—Å–µ—Ä–≤–µ—Ä –Ω–∞ –ø–æ—Ä—Ç—É `11020` (`mcp/McpServerManager.kt`).
- –°–µ–π—á–∞—Å –∞–∫—Ç–∏–≤–Ω—ã –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:
  - `dnd_campaigns` ‚Äî —á–∏—Ç–∞–µ—Ç `app/src/main/assets/mcp/my_dnd_campaigns.json`.
  - `dungeon_masters` ‚Äî —á–∏—Ç–∞–µ—Ç `app/src/main/assets/mcp/dungeons_masters.json`.
- –ö–æ–¥ GitHub‚Äë–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (`github_repos`, `github_issue_comments`) –æ—Å—Ç–∞–≤–ª–µ–Ω –≤ —Ñ–∞–π–ª–µ, –Ω–æ –æ—Ç–∫–ª—é—á—ë–Ω –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º. –ß—Ç–æ–±—ã –∏—Ö –≤–µ—Ä–Ω—É—Ç—å, —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –±–ª–æ–∫ –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `GITHUB_TOKEN` –∑–∞–¥–∞–Ω.
- –°–µ—Ä–≤–µ—Ä —Ç–∞–∫–∂–µ –¥–æ–±–∞–≤–ª—è–µ—Ç —Ä–µ—Å—É—Ä—Å `local://ai-challenge/status` –∏ prompt `local_capabilities`, —á—Ç–æ–±—ã MCP‚Äë–∫–ª–∏–µ–Ω—Ç –º–æ–≥ —É–∑–Ω–∞—Ç—å –æ–± –æ–∫—Ä—É–∂–µ–Ω–∏–∏.

### LocalKnowledgeMcpServerManager (knowledge)
- SSE‚Äë—Å–µ—Ä–≤–µ—Ä –Ω–∞ `11030` (`mcp/LocalKnowledgeMcpServerManager.kt`) —Å –¥–≤—É–º—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏:
  - `dnd_characters` ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –∏–∑ `app/src/main/assets/mcp/dnd_characters.json`.
  - `dnd_spells_for_class` ‚Äî —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç `dnd_spells.json` –ø–æ –ø–æ–ª—é `class_names` (–º–∞—Å—Å–∏–≤ —Å—Ç—Ä–æ–∫) –∏–ª–∏ —É—Å—Ç–∞—Ä–µ–≤—à–µ–º—É `class_name`.
- –≠—Ç–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ —Ç—Ä–µ–±—É—é—Ç —Ç–æ–∫–µ–Ω–æ–≤ –∏ –¥–æ—Å—Ç—É–ø–Ω—ã –æ—Ñ–ª–∞–π–Ω.

### MCP_TOOL —Ñ–æ—Ä–º–∞—Ç
LocalAiServer –æ–∂–∏–¥–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –≤—Å—Ç–∞–≤–∫–∏ –≤–∏–¥–∞:

```
MCP_TOOL: {"server":"core","name":"github_issue_comments","parameters":{"per_page":10}}
```

- `server` –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω ‚Äî –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `McpServers.primaryServerId` (`core`).
- –ü–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –µ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ —Ä–æ–ª—å `user` –∏ –º–æ–¥–µ–ª—å –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –æ—Ç–≤–µ—Ç, —É—á–∏—Ç—ã–≤–∞—è –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ.

## –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö end-to-end
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ `ChatScreen`, `ChatViewModel.sendMessage()` –¥–µ–ª–∞–µ—Ç `POST /chat`.
2. `LocalAiServer` (–∏–ª–∏ `HuggingFaceLocal`) —Å–æ–±–∏—Ä–∞–µ—Ç –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –≤—ã–∑—ã–≤–∞–µ—Ç –æ–±–ª–∞—á–Ω—É—é LLM.
3. –ï—Å–ª–∏ –º–æ–¥–µ–ª—å –∑–∞–ø—Ä–æ—Å–∏–ª–∞ MCP_TOOL, —Å–µ—Ä–≤–µ—Ä –≤—ã–∑—ã–≤–∞–µ—Ç –Ω—É–∂–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —á–µ—Ä–µ–∑ `McpClient`, –¥–æ–±–∞–≤–ª—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ LLM.
4. –û—Ç–≤–µ—Ç (–ø–ª—é—Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ) –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—É, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –∏—Å—Ç–æ—Ä–∏–∏ –∏ —Å—Ä–∞–∑—É –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ UI.
5. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) WebSocket `/issueSummary` –ø—É—à–∏—Ç —Å–≤–µ–∂–∏–µ summary, –∫–∞–∫ —Ç–æ–ª—å–∫–æ —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞–Ω–∏—è –∏—Ö —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª–∏.

## –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã
- `app/src/main/java/com/example/aichallenge/MainActivity.kt` ‚Äî —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤.
- `app/src/main/java/com/example/aichallenge/chat/ChatViewModel.kt` –∏ `ChatScreen.kt` ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è –∫–ª–∏–µ–Ω—Ç—Å–∫–∞—è –ª–æ–≥–∏–∫–∞.
- `app/src/main/java/com/example/aichallenge/server/LocalAiServer.kt` ‚Äî –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π MCP_TOOL, –∏—Å—Ç–æ—Ä–∏–∏ –∏ WebSocket.
- `app/src/main/java/com/example/aichallenge/server/HuggingFaceLocal.kt` ‚Äî –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –Ω–∞ Router API.
- `app/src/main/java/com/example/aichallenge/mcp/*` ‚Äî –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ MCP (—Å–µ—Ä–≤–µ—Ä—ã, –∫–ª–∏–µ–Ω—Ç, —ç–∫—Ä–∞–Ω –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤).

–î–æ–∫—É–º–µ–Ω—Ç –æ–±–Ω–æ–≤–ª—ë–Ω, —á—Ç–æ–±—ã –æ—Ç—Ä–∞–∑–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã: –¥–≤–∞ —á–∞—Ç‚Äë—Å–µ—Ä–≤–µ—Ä–∞, –æ—Ç–∫–ª—é—á—ë–Ω–Ω—ã–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é GitHub‚Äë–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, —Å–∂–∞—Ç–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –∏ –Ω–æ–≤—ã–µ —ç–∫—Ä–∞–Ω—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è MCP.
## User profiles and personalization
- StartScreen now has a "ƒ‡ÌÌ˚Â ÔÓÎ¸ÁÓ‚‡ÚÂÎˇ" button that opens a profile manager for adding, selecting, editing, or deleting entries.
- Profiles store name, language, country, city, time zone, preferred answer tone/format/length, expertise, interests, and custom notes. Data lives in filesDir/user_profiles.json so it persists locally.
- ChatViewModel attaches the selected profile to POST /chat, and LocalAiServer converts it into a short instruction inside the system prompt so Yandex GPT respects the user preferences. Without a profile everything works as before.


## Voice Input
- –ü–æ–ª–µ –≤–≤–æ–¥–∞ –≤ `ChatScreen` —Å—Ç–∞–ª–æ –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–º, –ø–æ—ç—Ç–æ–º—É –¥–ª–∏–Ω–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –Ω–µ "—Å–∫–∞—á—É—Ç" –∏ –æ—Å—Ç–∞—é—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.
- –†—è–¥–æ–º —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –¥–≤–µ –∫—Ä—É–≥–ª—ã–µ –∫–Ω–æ–ø–∫–∏: –º–∏–∫—Ä–æ—Ñ–æ–Ω –∑–∞–ø—É—Å–∫–∞–µ—Ç –≥–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥, —Å—Ç—Ä–µ–ª–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ (—Å–æ —Å–ø–∏–Ω–Ω–µ—Ä–æ–º, –µ—Å–ª–∏ –æ—Ç–≤–µ—Ç –µ—â—ë –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è).
- –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç `RECORD_AUDIO`; –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∑–∞–ø–∏—Å—å —Å—Ç–∞—Ä—Ç—É–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –∏–Ω–∞—á–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Ç–æ—Å—Ç —Å –ø–æ—è—Å–Ω–µ–Ω–∏–µ–º.
- –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ `android.speech.SpeechRecognizer`, –∞ –ø–æ–≤–µ—Ä—Ö —á–∞—Ç–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∑–∞—Ç–µ–º–Ω—ë–Ω–Ω—ã–π –æ–≤–µ—Ä–ª–µ–π —Å –ø—É–ª—å—Å–∏—Ä—É—é—â–µ–π –∏–∫–æ–Ω–∫–æ–π –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –∏ –ø–æ–¥–ø–∏—Å—å—é "–ì–æ–≤–æ—Ä–∏—Ç–µ...", —á—Ç–æ–±—ã –±—ã–ª–æ –≤–∏–¥–Ω–æ –∞–∫—Ç–∏–≤–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.
- –ö–æ–≥–¥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω, —Ç–µ–∫—Å—Ç –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ –ø–æ–ª–µ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ —á–∞—Ç, —Å–æ—Ö—Ä–∞–Ω—è—è –ø—Ä–∏–≤—ã—á–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –æ–±—â–µ–Ω–∏—è.
